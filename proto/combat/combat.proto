syntax = "proto3";
package combat;
option go_package = "github.com/komadiina/spelltext/proto/combat;combat";

import "repo/repo.proto";
import "health/health.proto";

message InitiateCombatRequest {
    uint64 character_id = 1;
    repeated uint64 npc_ids = 2;
}

message InitiateCombatResponse {
    repeated repo.Npc npcs = 1;
}

message ResolveCombatRequest {
    uint64 character_id = 1;
    repeated uint64 npc_ids = 2;
    repeated bool wins = 3;
}

message ResolveCombatResponse {
    uint64 xp_gained = 1;
    uint64 gold_gained = 2;
    uint64 tokens_gained = 3;
    repeated repo.Item items_gained = 4;
}

message ListNpcsRequest {
    // lists npc's whose min_level < character.level < max_level
    uint64 character_id = 1;
}

message ListNpcsResponse {
    repeated repo.Npc npcs = 1;
}


service Combat {
    rpc Check(health.HealthCheckRequest) returns (health.HealthCheckResponse);
    rpc ListNpcs(ListNpcsRequest) returns (ListNpcsResponse);
    rpc InitiateCombat(InitiateCombatRequest) returns (InitiateCombatResponse);
    rpc ResolveCombat(ResolveCombatRequest) returns (ResolveCombatResponse);
}